CC ?= gcc

CCNL_DEFINES = -DCCNL_UNIX -DUSE_CCNxDIGEST -DUSE_DUP_CHECK -DUSE_ECHO \
					-DUSE_HMAC256 -DUSE_IPV4 \
					-DUSE_IPV6 -DUSE_MGMT -DUSE_NFN_NSTRANS -DUSE_STATS -DUSE_UNIXSOCKET \
					-DNEEDS_PREFIX_MATCHING -DUSE_LOGGING

CCNL_PACKET_FORMATS = -DUSE_SUITE_CCNB -DUSE_SUITE_CCNTLV -DUSE_SUITE_CISTLV \
						-DUSE_SUITE_IOTTLV -DUSE_SUITE_NDNTLV -DUSE_SUITE_LOCALRPC


CCNL_DISABLED_FLAGS = USE_LINKLAYER USE_DEBUG USE_DEBUG_MALLOC USE_FRAG \
						USE_NACK USE_NFN USE_NFN_MONITOR USE_NFN_KEEPALIVE \
						USE_NFN_PULL USE_SCHEDULER USE_SIGNATURES -DUSE_HTTP_STATUS
 
CCNLCFLAGS = -Wall -Werror -std=c99 -g ${INCLUDES}  $(CCNL_DEFINES) $(CCNL_PACKET_FORMATS)

#ARFLAGS = rcs
ARFLAGS = -static -o
AR = libtool

SOURCES=$(wildcard *.c)
OBJECTS=$(patsubst %.c, %.o, $(SOURCES))

LIB = libccnl-unix.a

all: ${LIB}

$(OBJECTS): $(SOURCES)
	 $(CC) $(CCNLCFLAGS) -c $(SOURCES)

${LIB}: ${OBJECTS}
	${AR} ${ARFLAGS} $@ $^

clean: 
	rm -f *.o *.a
